!pip install peptides

from peptides import Peptide
import numpy as np
import pandas as pd

sequences = {
    "seq1": "MAFKSLIAFVALAAAVRAAPTAVCPDGTRVSHAACCAFIPLAQDLQETIFQNECGEDAHEVIRLTFHDAIAISRSQGPKAGGGADGSMLLFPTVEPNFSANNGIDDSVNNLIPFMQKHNTISAADLVQFAGAVALSNCPGAPRLEFLAGRPNKTIAAVDGLIPEPQDSVTKILQRFEDAGGFTPFEVVSLLASHSVARADKVDQTIDAAPFDSTPFTFDTQVFLEVLLKGVGFPGSANNTGEVASPLPLGSGSDTGEMRLQSDFALAHDPRTACIWQGFVNEQAFMAASFRAAMSKLAVLGHNRNSLIDCSDVVPVPKPATGQPAMFPASTGPQDLELSCPSERFPTLTTQPGASQSLIAHCPDGSMSCPGVQFNGPA",
    "seq2": "MQTLLVSSLVVSLAAALPHYIRSNGIEASLLTDPKDVSGRTVDYIIAGGGLTGLTTAARLTENPNISVLVIESGSYESDRGPIIEDLNAYGDIFGSSVDHAYETVELATNNQTALIRSGNGLGGSTLVNGGTWTRPHKAQVDSWETVFGNEGWNWDNVAAYSLQAERARAPNAKQIAAGHYFNASCHGVNGTVHAGPRDTGDDYSPIVKALMSAVEDRGVPTKKDFGCGDPHGVSMFPNTLHEDQVRSDAAREWLLPNYQRPNLQVLTGQYVGKVLLSQNGTTPRAVGVEFGTHKGNTHNVYAKHEVLLAAGSAVSPTILEYSGIGMKSILEPLGIDTVVDLPVGLNLQDQTTATVRSRITSAGAGQGQAAWFATFNETFGDYSEKAHELLNTKLEQWAEEAVARGGFHNTTALLIQYENYRDWIVNHNVAYSELFLDTAGVASFDVWDLLPFTRGYVHILDKDPYLHHFAYDPQYFLNELDLLGQAAATQLARNISNSGAMQTYFAGETIPGDNLAYDADLSAWTEYIPYHFRPNYHGVGTCSMMPKEMGGVVDNAARVYGVQGLRVIDGSIPPTQMSSHVMTVFYAMALKISDAILEDYASMQ",
    "seq3": "MKVLILACLVALALARELEELNVPGEIVESLSSSEESITRINKKIEKFQSEEQQQTEDELQDKIHPFAQTQSLVYPFPGPIPNSLPQNIPPLTQTPVVVPPFLQPEVMGVSKVKEAMAPKHKEMPFPKYPVEPFTESQSLTLTDVENLHLPLPLLQSWMHQPHQPLPPTVMFPPQSVLSLSQSKVLPVPQKAVPYPQRDMPIQAFLLYQEPVLGPVRGPFPIIV",
    "seq4": "MAHYRNDYKKNDEVEFVRTGYGKDMIKVLHIQRDGKYHSIKEVATSVQLTLSSKKDYLHGDNSDVIPTDTIKNTVNVLAKFKGIKSIETFAVTICEHFLSSFKHVIRAQVYVEEVPWKRFEKNGVKHVHAFIYTPTGTHFCEVEQIRNGPPVIHSGIKDLKVLKTTQSGFEGFIKDQFTTLPEVKDRCFATQVYCKWRYHQGRDVDFEATWDTVRSIVLQKFAGPYDKGEYSPSVQKTLYDIQVLTLGQVPEIEDMEISLPNIHYLNIDMSKMGLINKEEVLLPLDNPYGRITGTVKRKLTSRL",
    "seq5": "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLASSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA",
    "seq6": "MNPLLILTFVAAALAAPFDDDDKIVGGYNCEENSVPYQVSLNSGYHFCGGSLINEQWVVSAGHCYKSRIQVRLGEHNIEVLEGNEQFINAAKIIRHPQYDRKTLNNDIMLIKLSSRAVINARVSTISLPTAPPATGTKCLISGWGNTASSGADYPDELQCLDAPVLSQAKCEASYPGKITSNMFCVGFLEGGKDSCQGDSGGPVVCNGQLQGVVSWGDGCAQKNKPGVYTKVYNYVKWIKNTIAANS",
    "seq7": "MITLLFLLVVGAQAQHEWTYSEGVLDEKHWRLQYPDCGGTRQSPIDLKMKKVRYNPSLRALNLTGYGLRQGEFPMTNNGHTVQISLPSSMRMTTSDGSQYLAKQMHFHWGGDSSEISGSEHTVDGMRYIIEIHVVHYHSKYGSYEEAQNEPDGLAVLAALVEVKDYAENTYYSNFISHLEDIRYAGQSTVLRDLDIQDMLPGDLRYYYSYLGSLTTPSCTENVHWFVVADTVKLSKTQIEKLENSLLNHQNETIQNNYRSTQPLNHRVVEANFVSHPHQEYTLGSKLHFYLNNIDQNLEYLRRFIEQKITKRKKEKYWP",
    "seq8": "MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL",
    "seq9": "MKLKTKASIKFGICVGLLCLSITGFTPFFNSTHAEAKSIEDTNMASCITNKKFVQLEKKFDARLGVYAIDIGSNKTIAYRPNERFAYASTYKVLAAAAVLKKNSIEKLNEVIHYSKDDLVTYSPITEKHLDTGMSLKEISEAAIRYSDNTAGNILLQQLGGPKGFEKSLKQIGDHVTKAKRFETDLNSAIPGDIRDTSTAKALATDLKAFTLDNTLTTDKRMILTDWMRGNATGDELIRAGAPIGWEVGDKSGAGSYGTRNDIAIVWPPNRAPIVVAILSNRFTKDANYDNALIAEAAKVVLNDLK",
    "seq10": "MRERGPQRVAAHITGTRGRSNTLSSPNSKNEKALGRKINSWESSRSGHSFLSNLHLRNGELVIHEKGFYYIYSQTYFRFQEEIKENTKNDKQMVQYIYKYTSYPDPILLMKSARNSCWSKDAEYGLYSIYQGGIFELKENDRIFVSVTNEHLIDMDHEASFFGAFLVG"
}

# 2) Define a helper function
def encode_vhse(seqs_dict):
    """Return a DataFrame of rounded VHSE scales for each sequence."""
    data = {}
    for name, seq in seqs_dict.items():
        vhse_vals = Peptide(seq).vhse_scales()      # yields an array of length 8
        data[name]   = np.round(vhse_vals, 4)
    # build DataFrame: rows are sequences, cols are VHSE1â€¦VHSE8
    df = pd.DataFrame.from_dict(
        data, orient="index",
        columns=[f"VHSE{i}" for i in range(1, 9)]
    )
    return df

vhse_df = encode_vhse(sequences)
print(vhse_df)

vhse_df.to_csv("Protein Encoding.csv", index=False)
